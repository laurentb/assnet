<%inherit file="layout.html"/>
<%namespace name="partials" file="partials.html"/>
<%
event_classes = {
    event.USER_WAITING: 'event_waiting',
    event.USER_CONFIRMED: 'event_confirmed',
    event.USER_DECLINED: 'event_declined',
}
%>

${partials.loginbox()}

<h2>${event.title | h}</h2>

% if error_message is not None:
    <p class="error_message">${error_message | h}</p>
% endif
% if confirm_message is not None:
    <p class="confirm_message">${confirm_message | h}</p>
% endif

<p>${event.summary | h}</p>

<h3>Date</h3>
<p>${event.date | h}</p>

<h3>Place</h3>
<p>${event.place | h}</p>

<h3>Attendees</h3>
<ul>
% for event_user in event.iter_users():
    <% state = event.users[event_user.name] %>
    <li class="${event_classes[state] | h}">
        [${event.get_sign(state) | h}] ${partials.display_user(event_user)}
    </li>
% endfor
</ul>

% if user_state is not None:
<h3>Confirmation</h3>
    <p>
    Your current status is:
    % if user_state == event.USER_WAITING:
        <strong>waiting</strong>.
    % elif user_state == event.USER_CONFIRMED:
        <strong>confirmed</strong>.
    % elif user_state == event.USER_DECLINED:
        <strong>declined</strong>.
    % endif
    </p>
    <form method="post">
        % if user_state != event.USER_CONFIRMED:
            <input name="action" type="submit" value="Confirm"/>
        % endif
        % if user_state != event.USER_DECLINED:
            <input name="action" type="submit" value="Decline"/>
        % endif
    </form>
% endif

<%def name="title()">Event ${path | h}</%def>
